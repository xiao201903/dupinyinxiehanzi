<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ±‰å­—ç”°å­—æ ¼ç±³å­—æ ¼ç”Ÿæˆå™¨ï¼ˆA4æ‰“å°/æ‹¼éŸ³æ ‡æ³¨ä¸“ç”¨ï¼‰</title>
    <style>
        * {margin: 0; padding: 0; box-sizing: border-box;}
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f8f9fa;
            color: #333;
            padding: 20px 10px;
        }
        .header {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto 20px;
            padding: 15px 20px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            border-bottom: 3px solid #2f54eb;
        }
        .header h1 {
            font-size: 20px;
            color: #2f54eb;
            font-weight: 600;
            text-align: center;
        }
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            gap: 20px;
            align-items: flex-start;
        }
        .control-box {
            width: 280px;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            flex-shrink: 0;
        }
        .control-group {
            margin-bottom: 18px;
        }
        .control-group label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            color: #555;
            font-weight: 500;
        }
        input[type=number], input[type=text], textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            color: #333;
            resize: none;
        }
        textarea {
            min-height: 80px;
            line-height: 1.5;
        }
        input[type=color] {
            width: 48%;
            height: 40px;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
        }
        .btn-group {
            display: flex;
            gap: 8px;
            margin-bottom: 18px;
        }
        .btn-small-group {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }
        .btn-small {
            padding: 6px 0;
            font-size: 12px;
        }
        .margin-group, .title-set-group, .char-set-group {
            display: flex;
            flex-wrap: wrap;
            gap: 3% 4%;
        }
        .margin-item, .title-item, .char-item {
            width: 48%;
            margin-bottom: 8px;
        }
        .margin-item label, .title-item label, .char-item label {
            font-size: 12px;
            margin-bottom: 4px;
        }
        .margin-item input, .title-item input, .char-item input {
            padding: 6px;
            font-size: 13px;
        }
        button {
            width: 100%;
            padding: 10px 0;
            border: none;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        .btn-primary {background: #2f54eb; color: #fff;}
        .btn-primary:hover {background: #1d42d1;}
        .btn-success {background: #198754; color: #fff;}
        .btn-success:hover {background: #146c43;}
        .btn-secondary {background: #6c757d; color: #fff;}
        .btn-secondary:hover {background: #5c636a;}
        .btn-warning {background: #ffc107; color: #212529;}
        .btn-warning:hover {background: #ffb300;}
        .color-group {display: flex; gap: 4%;}
        .preview-box {
            flex: 1;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            text-align: center;
        }
        .preview-title {
            font-size: 14px;
            color: #555;
            margin-bottom: 15px;
            font-weight: 500;
        }
        :root {
            --grid-mm: 10mm;
            --border-color: #000000;
            --line-color: #000000;
            --margin-top: 8mm;
            --margin-bottom: 8mm;
            --margin-left: 10mm;
            --margin-right: 10mm;
            --title-font-size: 16px;
            --title-color: #000000;
            --title-mt: 0mm;
            --title-mb: 5mm;
            --pinyin-color: #f53f3f;
            --pinyin-size: 12px;
            --char-color: #000000;
            --char-size: 24px;
        }
        .a4-container {
            width: 210mm;
            height: 297mm;
            background: #fff;
            padding: var(--margin-top) var(--margin-right) var(--margin-bottom) var(--margin-left);
            margin: 0 auto;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            overflow: hidden;
            position: relative;
        }
        .grid-title {
            width: 100%;
            text-align: center;
            font-size: var(--title-font-size);
            color: var(--title-color);
            margin-top: var(--title-mt);
            margin-bottom: var(--title-mb);
            font-weight: 600;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        /* æ ¸å¿ƒï¼šç”°å­—æ ¼å†…æ‹¼éŸ³+æ±‰å­—å¸ƒå±€ */
        .char-grid {
            width: var(--grid-mm);
            height: var(--grid-mm);
            border: 1px solid var(--border-color);
            display: inline-block;
            margin: 0.3mm;
            position: relative;
            text-align: center;
            font-family: "SimSun", "å®‹ä½“", serif;
        }
        /* æ‹¼éŸ³å®¹å™¨ï¼šç½®é¡¶æ˜¾ç¤ºï¼Œå±…ä¸­å¯¹é½ */
        .pinyin-wrap {
            position: absolute;
            top: 0.5mm;
            left: 0;
            width: 100%;
            height: 30%;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        .pinyin-text {
            font-size: var(--pinyin-size);
            color: var(--pinyin-color);
            font-weight: 500;
            line-height: 1;
        }
        /* æ±‰å­—å®¹å™¨ï¼šå±…ä¸­æ˜¾ç¤ºï¼Œå æ ¼å­ä¸»ä½“ */
        .char-wrap {
            position: absolute;
            top: 30%;
            left: 0;
            width: 100%;
            height: 70%;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        .char-text {
            font-size: var(--char-size);
            color: var(--char-color);
            font-weight: 600;
            line-height: 1;
        }
        /* æ±‰å­—éšè—æ ·å¼ï¼šé€šè¿‡ç±»æ§åˆ¶æ˜¾éš */
        .char-hidden .char-text {
            visibility: hidden;
        }

        .char-grid.tian::before, .char-grid.tian::after {
            content: ''; position: absolute; background: none;
            left: 50%; top: 0; width: 0.8px; height: 100%;
            transform: translateX(-50%); border-left: 0.8px dashed var(--line-color);
            z-index: 1;
        }
        .char-grid.tian::after {
            left: 0; top: 50%; width: 100%; height: 0.8px;
            transform: translateY(-50%); border-top: 0.8px dashed var(--line-color);
            z-index: 1;
        }
        .char-grid.mi {position: relative;}
        .char-grid.mi::before {
            content: ''; position: absolute; background: none;
            left: 50%; top: 0; width: 0.8px; height: 100%;
            transform: translateX(-50%); border-left: 0.8px dashed var(--line-color);
            z-index: 1;
        }
        .char-grid.mi::after {
            content: ''; position: absolute; background: none;
            left: 0; top: 50%; width: 100%; height: 0.8px;
            transform: translateY(-50%); border-top: 0.8px dashed var(--line-color);
            z-index: 1;
        }
        .char-grid.mi .diag-1 {
            content: ''; position: absolute; background: none;
            left: 50%; top: 50%; width: 141%; height: 0.8px;
            transform: translate(-50%,-50%) rotate(45deg); border-top: 0.8px dashed var(--line-color);
            z-index: 1;
        }
        .char-grid.mi .diag-2 {
            content: ''; position: absolute; background: none;
            left: 50%; top: 50%; width: 141%; height: 0.8px;
            transform: translate(-50%,-50%) rotate(-45deg); border-top: 0.8px dashed var(--line-color);
            z-index: 1;
        }
        .grid-row {line-height: 0; margin-bottom: 0.5mm; white-space: nowrap;}
        .grid-wrap {width: 100%; height: 100%; overflow: hidden;}
        /* æ‰“å°æ ·å¼åŒæ­¥æ‰€æœ‰è®¾ç½® */
        @media print {
            body {padding: 0; background: #fff;}
            .header, .control-box, .preview-title {display: none !important;}
            .preview-box {padding: 0; box-shadow: none; background: #fff;}
            .a4-container {
                width: 210mm; 
                height: 297mm; 
                padding: var(--margin-top) var(--margin-right) var(--margin-bottom) var(--margin-left);
                margin: 0; 
                box-shadow: none;
            }
            .char-grid {margin: 0.2mm; border-width: 0.6px;}
            .grid-title {font-weight: 600;}
            .pinyin-text {font-size: 10px;}
            .char-text {font-size: 20px;}
            @page {size: A4 portrait; margin: 0;}
        }
        /* ç§»åŠ¨ç«¯é€‚é… */
        @media (max-width: 900px) {
            .container {flex-direction: column; align-items: center;}
            .control-box {width: 100%; max-width: 350px;}
            .a4-container {width: 95vw; height: 135vw; padding: 3vw;}
            .grid-title {font-size: 4vw;}
            .pinyin-text {font-size: 3vw;}
            .char-text {font-size: 6vw;}
        }
    </style>
    <!-- å¼•å…¥æ‹¼éŸ³è½¬æ¢æ’ä»¶ï¼špinyin-proï¼Œæ”¯æŒç²¾å‡†æ±‰å­—è½¬æ‹¼éŸ³ -->
    <script src="https://cdn.jsdelivr.net/npm/pinyin-pro@3.18.0/dist/pinyin-pro.min.js"></script>
</head>
<body>
    <div class="header">
        <h1>æ±‰å­—ç”°å­—æ ¼Â·ç±³å­—æ ¼ç”Ÿæˆå™¨ï¼ˆæ‹¼éŸ³æ ‡æ³¨/A4æ‰“å°ä¸“ç”¨ï¼‰</h1>
    </div>

    <div class="container">
        <div class="control-box">
            <!-- æ ‡é¢˜è®¾ç½®åŒº -->
            <div class="control-group">
                <label>ç»ƒå­—æ ‡é¢˜è®¾ç½® ã€å†…å®¹/å­—å·/é¢œè‰²/é—´è·ã€‘</label>
                <input type="text" id="titleText" placeholder="è¾“å…¥æ ‡é¢˜ï¼Œå¦‚ï¼šä¸€å¹´çº§è¯­æ–‡ç»ƒå­—" value="ä¸€å¹´çº§è¯­æ–‡ç»ƒå­—">
                <div class="title-set-group">
                    <div class="title-item">
                        <label>æ ‡é¢˜å­—å·(px)</label>
                        <input type="number" id="titleFontSize" value="16" min="12" max="30" step="1">
                    </div>
                    <div class="title-item">
                        <label>ä¸Šé—´è·(mm)</label>
                        <input type="number" id="titleMt" value="0" min="0" max="10" step="0.5">
                    </div>
                    <div class="title-item">
                        <label>æ ‡é¢˜é¢œè‰²</label>
                        <input type="color" id="titleColor" value="#000000">
                    </div>
                    <div class="title-item">
                        <label>ä¸‹é—´è·(mm)</label>
                        <input type="number" id="titleMb" value="5" min="2" max="15" step="0.5">
                    </div>
                </div>
            </div>

            <!-- æ ¸å¿ƒæ–°å¢ï¼šæ±‰å­—æ‹¼éŸ³è®¾ç½®åŒº -->
            <div class="control-group">
                <label>ç»ƒå­—æ±‰å­—è¾“å…¥ ã€è‡ªåŠ¨æ ‡æ‹¼éŸ³ï¼ŒæŒ‰æ ¼å­æ•°é€‚é…ã€‘</label>
                <textarea id="charText" placeholder="è¯·è¾“å…¥çº¯æ±‰å­—ï¼Œæ— éœ€ç©ºæ ¼/æ ‡ç‚¹ï¼Œå¦‚ï¼šå¤©åœ°äººä½ æˆ‘ä»–ä¸€äºŒä¸‰å››äº”" rows="3">å¤©åœ°äººä½ æˆ‘ä»–ä¸€äºŒä¸‰å››äº”é‡‘æœ¨æ°´ç«åœŸä¸Šä¸‹æ—¥æœˆé£äº‘é›¨é›ª</textarea>
                <div class="char-set-group">
                    <div class="char-item">
                        <label>æ‹¼éŸ³é¢œè‰²</label>
                        <input type="color" id="pinyinColor" value="#f53f3f">
                    </div>
                    <div class="char-item">
                        <label>æ‹¼éŸ³å­—å·(px)</label>
                        <input type="number" id="pinyinSize" value="12" min="8" max="16" step="1">
                    </div>
                    <div class="char-item">
                        <label>æ±‰å­—é¢œè‰²</label>
                        <input type="color" id="charColor" value="#000000">
                    </div>
                    <div class="char-item">
                        <label>æ±‰å­—å­—å·(px)</label>
                        <input type="number" id="charSize" value="24" min="16" max="32" step="1">
                    </div>
                </div>
                <div class="btn-small-group">
                    <button class="btn-warning btn-small" onclick="toggleCharShow()">ğŸ–Œï¸ åˆ‡æ¢æ±‰å­—æ˜¾éš</button>
                </div>
                <div style="font-size:12px;color:#999;margin-top:6px;">æç¤ºï¼šæ±‰å­—é»˜è®¤éšè—ï¼Œä»…æ˜¾ç¤ºæ‹¼éŸ³ï¼›æ ¼å­æ•°ä¸è¶³æ—¶è‡ªåŠ¨æˆªæ–­</div>
            </div>

            <!-- æ ¼å­åŸºç¡€è®¾ç½® -->
            <div class="control-group">
                <label>æ ¼å­å°ºå¯¸ (mm) ã€ä½å¹´çº§10/é«˜å¹´çº§8ã€‘</label>
                <input type="number" id="gridMm" value="10" min="6" max="15" step="0.5">
            </div>
            <div class="control-group">
                <label>ç”°å­—æ ¼è¡Œæ•°</label>
                <input type="number" id="gridRows" value="25" min="10" max="30">
            </div>
            <div class="control-group">
                <label>æ¯è¡Œæ ¼å­æ•°é‡</label>
                <input type="number" id="gridCols" value="18" min="10" max="22">
            </div>

            <!-- é¡µè¾¹è·è®¾ç½® -->
            <div class="control-group">
                <label>è‡ªå®šä¹‰é¡µè¾¹è· (mm) ã€é»˜è®¤ä¸Š8/ä¸‹8/å·¦10/å³10ã€‘</label>
                <div class="margin-group">
                    <div class="margin-item">
                        <label>ä¸Šè¾¹è·</label>
                        <input type="number" id="marginTop" value="8" min="2" max="20" step="0.5">
                    </div>
                    <div class="margin-item">
                        <label>ä¸‹è¾¹è·</label>
                        <input type="number" id="marginBottom" value="8" min="2" max="20" step="0.5">
                    </div>
                    <div class="margin-item">
                        <label>å·¦è¾¹è·</label>
                        <input type="number" id="marginLeft" value="10" min="2" max="20" step="0.5">
                    </div>
                    <div class="margin-item">
                        <label>å³è¾¹è·</label>
                        <input type="number" id="marginRight" value="10" min="2" max="20" step="0.5">
                    </div>
                </div>
            </div>

            <!-- æ ¼å­é¢œè‰²è®¾ç½® -->
            <div class="control-group">
                <label>æ ¼å­é¢œè‰²è®¾ç½®ï¼ˆç‹¬ç«‹å¯è°ƒï¼‰</label>
                <div class="color-group">
                    <input type="color" id="borderColor" value="#000000" title="è¾¹æ¡†é¢œè‰²">
                    <div style="width: 48%;"><input type="color" id="lineColor" value="#000000" title="è™šçº¿é¢œè‰²"></div>
                </div>
            </div>

            <!-- åŠŸèƒ½æŒ‰é’® -->
            <div class="btn-group">
                <button class="btn-success" onclick="switchGrid('tian')">ç”°å­—æ ¼</button>
                <button class="btn-success" onclick="switchGrid('mi')">ç±³å­—æ ¼</button>
            </div>
            <button class="btn-primary" onclick="createGrid()">âœ… åˆ·æ–°ç”Ÿæˆæ ¼å­</button>
            <button class="btn-secondary" onclick="window.print()">ğŸ–¨ï¸ æ‰“å°ç”°å­—æ ¼</button>
        </div>

        <div class="preview-box">
            <div class="preview-title">A4çº¸1:1é¢„è§ˆï¼ˆæ‹¼éŸ³ç½®é¡¶/æ±‰å­—å¯éšï¼‰</div>
            <div class="a4-container">
                <div class="grid-title" id="gridTitle"></div>
                <div class="grid-wrap" id="gridContainer"></div>
            </div>
        </div>
    </div>

    <script>
        let currentGridType = 'tian';
        let isCharHidden = true; // æ±‰å­—é»˜è®¤éšè—
        // é¡µé¢åŠ è½½åˆå§‹åŒ–+å…¨å‚æ•°æœ¬åœ°è®°å¿†
        window.onload = () => {
            initAllParams();
            createGrid();
        }

        // æœ¬åœ°å­˜å‚¨ åˆå§‹åŒ–æ‰€æœ‰å‚æ•°ï¼ˆæ–°å¢æ‹¼éŸ³/æ±‰å­—ç›¸å…³ï¼‰
        function initAllParams() {
            // åŸæœ‰å‚æ•°
            const mm = localStorage.getItem('gridMm') || 10;
            const rows = localStorage.getItem('gridRowsMm') || 25;
            const cols = localStorage.getItem('gridColsMm') || 18;
            const border = localStorage.getItem('borderColor') || '#000000';
            const line = localStorage.getItem('lineColor') || '#000000';
            const mt = localStorage.getItem('marginTop') || 8;
            const mb = localStorage.getItem('marginBottom') || 8;
            const ml = localStorage.getItem('marginLeft') || 10;
            const mr = localStorage.getItem('marginRight') || 10;
            const type = localStorage.getItem('gridType') || 'tian';
            const titleText = localStorage.getItem('titleText') || 'ä¸€å¹´çº§è¯­æ–‡ç»ƒå­—';
            const titleFontSize = localStorage.getItem('titleFontSize') || 16;
            const titleColor = localStorage.getItem('titleColor') || '#000000';
            const titleMt = localStorage.getItem('titleMt') || 0;
            const titleMb = localStorage.getItem('titleMb') || 5;
            // æ–°å¢ï¼šæ‹¼éŸ³/æ±‰å­—å‚æ•°
            const charText = localStorage.getItem('charText') || 'å¤©åœ°äººä½ æˆ‘ä»–ä¸€äºŒä¸‰å››äº”é‡‘æœ¨æ°´ç«åœŸä¸Šä¸‹æ—¥æœˆé£äº‘é›¨é›ª';
            const pinyinColor = localStorage.getItem('pinyinColor') || '#f53f3f';
            const pinyinSize = localStorage.getItem('pinyinSize') || 12;
            const charColor = localStorage.getItem('charColor') || '#000000';
            const charSize = localStorage.getItem('charSize') || 24;
            isCharHidden = localStorage.getItem('isCharHidden') === 'false' ? false : true;

            // èµ‹å€¼åˆ°è¾“å…¥æ¡†
            document.getElementById('gridMm').value = mm;
            document.getElementById('gridRows').value = rows;
            document.getElementById('gridCols').value = cols;
            document.getElementById('borderColor').value = border;
            document.getElementById('lineColor').value = line;
            document.getElementById('marginTop').value = mt;
            document.getElementById('marginBottom').value = mb;
            document.getElementById('marginLeft').value = ml;
            document.getElementById('marginRight').value = mr;
            document.getElementById('titleText').value = titleText;
            document.getElementById('titleFontSize').value = titleFontSize;
            document.getElementById('titleColor').value = titleColor;
            document.getElementById('titleMt').value = titleMt;
            document.getElementById('titleMb').value = titleMb;
            document.getElementById('charText').value = charText;
            document.getElementById('pinyinColor').value = pinyinColor;
            document.getElementById('pinyinSize').value = pinyinSize;
            document.getElementById('charColor').value = charColor;
            document.getElementById('charSize').value = charSize;

            currentGridType = type;
        }

        // æ ¸å¿ƒç”Ÿæˆå‡½æ•°ï¼šæ•´åˆæ‹¼éŸ³/æ±‰å­—/æ ‡é¢˜/é¡µè¾¹è·æ‰€æœ‰åŠŸèƒ½
        function createGrid() {
            // è·å–æ‰€æœ‰å‚æ•°
            const mm = document.getElementById('gridMm').value;
            const rows = document.getElementById('gridRows').value;
            const cols = document.getElementById('gridCols').value;
            const borderColor = document.getElementById('borderColor').value;
            const lineColor = document.getElementById('lineColor').value;
            const mt = document.getElementById('marginTop').value;
            const mb = document.getElementById('marginBottom').value;
            const ml = document.getElementById('marginLeft').value;
            const mr = document.getElementById('marginRight').value;
            const titleText = document.getElementById('titleText').value || 'ä¸€å¹´çº§è¯­æ–‡ç»ƒå­—';
            const titleFontSize = document.getElementById('titleFontSize').value;
            const titleColor = document.getElementById('titleColor').value;
            const titleMt = document.getElementById('titleMt').value;
            const titleMb = document.getElementById('titleMb').value;
            // æ‹¼éŸ³/æ±‰å­—æ ¸å¿ƒå‚æ•°
            let charText = document.getElementById('charText').value || '';
            const pinyinColor = document.getElementById('pinyinColor').value;
            const pinyinSize = document.getElementById('pinyinSize').value;
            const charColor = document.getElementById('charColor').value;
            const charSize = document.getElementById('charSize').value;

            const container = document.getElementById('gridContainer');
            const titleDom = document.getElementById('gridTitle');
            container.innerHTML = '';
            titleDom.innerText = titleText;

            // å¤„ç†æ±‰å­—ï¼šè¿‡æ»¤éæ±‰å­—å­—ç¬¦ï¼Œä»…ä¿ç•™çº¯æ±‰å­—
            charText = charText.replace(/[^\u4e00-\u9fa5]/g, '');
            // è®¡ç®—æ€»æ ¼å­æ•°ï¼Œæ±‰å­—æ•°è¶…å‡ºæ—¶è‡ªåŠ¨æˆªæ–­
            const totalGrid = rows * cols;
            const validChars = charText.slice(0, totalGrid).split('');
            // æ±‰å­—è½¬æ‹¼éŸ³ï¼šä½¿ç”¨pinyin-proæ’ä»¶ï¼Œç”Ÿæˆå¸¦å£°è°ƒçš„æ‹¼éŸ³
            const pinyinList = validChars.map(char => {
                return pinyinPro(char, { toneType: 'symbol', type: 'string' });
            });

            // å­˜å‚¨æ‰€æœ‰å‚æ•°åˆ°æœ¬åœ°ï¼ˆå«æ‹¼éŸ³/æ±‰å­—ï¼‰
            localStorage.setItem('gridMm', mm);
            localStorage.setItem('gridRowsMm', rows);
            localStorage.setItem('gridColsMm', cols);
            localStorage.setItem('borderColor', borderColor);
            localStorage.setItem('lineColor', lineColor);
            localStorage.setItem('marginTop', mt);
            localStorage.setItem('marginBottom', mb);
            localStorage.setItem('marginLeft', ml);
            localStorage.setItem('marginRight', mr);
            localStorage.setItem('gridType', currentGridType);
            localStorage.setItem('titleText', titleText);
            localStorage.setItem('titleFontSize', titleFontSize);
            localStorage.setItem('titleColor', titleColor);
            localStorage.setItem('titleMt', titleMt);
            localStorage.setItem('titleMb', titleMb);
            localStorage.setItem('charText', charText);
            localStorage.setItem('pinyinColor', pinyinColor);
            localStorage.setItem('pinyinSize', pinyinSize);
            localStorage.setItem('charColor', charColor);
            localStorage.setItem('charSize', charSize);
            localStorage.setItem('isCharHidden', isCharHidden);

            // èµ‹å€¼CSSå˜é‡ï¼ˆå«æ‹¼éŸ³/æ±‰å­—æ ·å¼ï¼‰
            document.documentElement.style.setProperty('--grid-mm', mm + 'mm');
            document.documentElement.style.setProperty('--border-color', borderColor);
            document.documentElement.style.setProperty('--line-color', lineColor);
            document.documentElement.style.setProperty('--margin-top', mt + 'mm');
            document.documentElement.style.setProperty('--margin-bottom', mb + 'mm');
            document.documentElement.style.setProperty('--margin-left', ml + 'mm');
            document.documentElement.style.setProperty('--margin-right', mr + 'mm');
            document.documentElement.style.setProperty('--title-font-size', titleFontSize + 'px');
            document.documentElement.style.setProperty('--title-color', titleColor);
            document.documentElement.style.setProperty('--title-mt', titleMt + 'mm');
            document.documentElement.style.setProperty('--title-mb', titleMb + 'mm');
            document.documentElement.style.setProperty('--pinyin-color', pinyinColor);
            document.documentElement.style.setProperty('--pinyin-size', pinyinSize + 'px');
            document.documentElement.style.setProperty('--char-color', charColor);
            document.documentElement.style.setProperty('--char-size', charSize + 'px');

            // å¾ªç¯ç”Ÿæˆè¡Œåˆ—+æ‹¼éŸ³+æ±‰å­—
            let charIndex = 0;
            for(let i=0; i<rows; i++){
                const row = document.createElement('div');
                row.className = 'grid-row';
                for(let j=0; j<cols; j++){
                    const grid = document.createElement('div');
                    // æ·»åŠ æ˜¾éšç±»ï¼šé»˜è®¤éšè—æ±‰å­—
                    const gridClass = `char-grid ${currentGridType} ${isCharHidden ? 'char-hidden' : ''}`;
                    grid.className = gridClass;
                    
                    // åˆ›å»ºæ‹¼éŸ³å®¹å™¨
                    const pinyinWrap = document.createElement('div');
                    pinyinWrap.className = 'pinyin-wrap';
                    const pinyinText = document.createElement('span');
                    pinyinText.className = 'pinyin-text';
                    pinyinText.innerText = pinyinList[charIndex] || '';
                    pinyinWrap.appendChild(pinyinText);

                    // åˆ›å»ºæ±‰å­—å®¹å™¨
                    const charWrap = document.createElement('div');
                    charWrap.className = 'char-wrap';
                    const charText = document.createElement('span');
                    charText.className = 'char-text';
                    charText.innerText = validChars[charIndex] || '';
                    charWrap.appendChild(charText);

                    // æ‹¼å…¥æ ¼å­
                    grid.appendChild(pinyinWrap);
                    grid.appendChild(charWrap);
                    row.appendChild(grid);
                    
                    charIndex++;
                }
                container.appendChild(row);
            }
        }

        // ç”°/ç±³å­—æ ¼åˆ‡æ¢
        function switchGrid(type) {
            currentGridType = type;
            createGrid();
        }

        // æ ¸å¿ƒæ–°å¢ï¼šåˆ‡æ¢æ±‰å­—æ˜¾éšçŠ¶æ€ï¼ˆæ— éœ€é‡æ–°ç”Ÿæˆæ ¼å­ï¼‰
        function toggleCharShow() {
            isCharHidden = !isCharHidden;
            localStorage.setItem('isCharHidden', isCharHidden);
            // æ‰¹é‡åˆ‡æ¢æ‰€æœ‰æ ¼å­çš„æ˜¾éšç±»ï¼Œå®æ—¶ç”Ÿæ•ˆ
            const allGrids = document.querySelectorAll('.char-grid');
            allGrids.forEach(grid => {
                if(isCharHidden) {
                    grid.classList.add('char-hidden');
                } else {
                    grid.classList.remove('char-hidden');
                }
            });
            // æç¤ºæ–‡å­—æ›´æ–°
            const btn = document.querySelector('.btn-warning');
            btn.innerText = isCharHidden ? 'ğŸ–Œï¸ æ˜¾ç¤ºæ±‰å­—' : 'ğŸ–Œï¸ éšè—æ±‰å­—';
        }
    </script>
</body>
</html>
